---
import BlogPost from '@/layouts/BlogPost.astro'
import { getCollection, render } from 'astro:content'
import dayjs from 'dayjs'
import utc from 'dayjs/plugin/utc'
dayjs.extend(utc)

// Define all possible static paths
export async function getStaticPaths() {
  const posts = await getCollection('phenomena')
  return posts.map(post => ({
    params: { id: post.id },
    props: post,
  }))
}

// Render markdown content
const post = Astro.props
const { Content, remarkPluginFrontmatter } = await render(post)
const minutesRead = remarkPluginFrontmatter.minutesRead
const lastModifiedTime = dayjs(remarkPluginFrontmatter.lastModified)
  .utc()
  .format('MMM D, YYYY')

// Merge frontmatter with additional props
const props = {
  ...post.data,
  minutesRead,
  lastModifiedTime,
}
---

<BlogPost {...props}>
  <Content />
</BlogPost>
