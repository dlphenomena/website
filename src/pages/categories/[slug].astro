---
import CategoryPosts from '@/layouts/CategoryPosts.astro'
import { getCollection } from 'astro:content'

export async function getStaticPaths() {
  const allPosts = await getCollection('phenomena')
  const allTags = new Set<string>()
  allPosts.forEach(post => {
    post.data.tags?.forEach((tag: string) => {
      allTags.add(tag)
    })
  })

  return Array.from(allTags).map(tag => {
    return {
      params: { slug: tag.toLowerCase() },
      props: { name: tag },
    }
  })
}

const { name } = Astro.props
---

<CategoryPosts category={name} />
